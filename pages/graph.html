<div data-role="page">
  <div class="navbar light-green darken-2">
    <div class="navbar-inner">
      <div class="left">
        <a href="#" class="link" data-rel="back"><i class="material-icons">arrow_back</i></a>
      </div>
      <div class="title">Vẽ đồ thị</div>
    </div>
  </div>
  <div class="ui-content">
    <div class="card">
      <label>Nhập hàm số</label>
      <input type="text" data-clear-btn="true" id="input" placeholder="x:cos(x)" />
    </div>
    <div class="card">
      <div class="overflow center">
        <div id="plot"></div>
      </div>
    </div>
  </div>
  <script>
  $.getScript('../js/graph.js', function() {

    $('#input').textcomplete([{
      match: /(^|\b)(\w{1,})$/,
      search: function(term, callback) {
        var words = ['cos', 'sin', 'tan', 'sqrt', 'abs', 'asin', 'acos', 'atan'];
        callback($.map(words, function(word) {
          return word.indexOf(term) === 0 ? word : null;
        }));
      },
      replace: function(word) {
        return `${word}()`;
      }
    }]);

    functionPlot({
      target: '#plot',
      grid: true,
      width: 350,
      tip: {
        xLine: true,
        yLine: true,
      },
      data: [{
        fn: '0'
      }]
    });

    $('#input').on('input', function(event) {
      event.preventDefault();
      let arrInput = input.value.replace(/ln/g, 'log').split(':');
      let arrData = [];
      for (let i = 0; i < arrInput.length; i++) {
      	arrData.push(JSON.parse(`{"fn":"${arrInput[i]}"}`));
      }
      functionPlot({
        target: '#plot',
        grid: true,
        width: 350,
        tip: {
          xLine: true,
          yLine: true,
        },
        data: arrData
      });
    })
  })
  </script>
</div>