"undefined"!=typeof module&&(nerdamer=require("./nerdamer.core.js"),require("./Calculus"),require("./Algebra")),function(){var t=nerdamer.getCore(),e=t.PARSER,i=t.Symbol,n=t.Utils.format,s=t.Utils.isVector,r=t.groups.S,a=(t.groups.EX,t.groups.CP),o=t.groups.CB,l=t.groups.FN;t.Settings.Laplace_integration_depth=40,i.prototype.findFunction=function(t){if(this.group===l&&this.fname===t)return this.clone();var e;if(this.symbols)for(var i in this.symbols)if(e=this.symbols[i].findFunction(t))break;return e};var u=t.Extra={version:"1.4.1",LaPlace:{transform:function(s,a,c){a=a.toString();var p,m=(s=i.unwrapSQRT(s,!0)).stripVar(a),d=s.group;if((s=e.divide(s,m.clone())).isConstant()||!s.contains(a,!0))p=e.parse(n("({0})/({1})",s,c));else if(d===r&&t.Utils.isInt(s.power)){var f=String(s.power);p=e.parse(n("factorial({0})/({1})^({0}+1)",f,c))}else if(s.group===r&&s.power.equals(.5))p=e.parse(n("sqrt(pi)/(2*({0})^(3/2))",c));else if(s.isComposite())p=new i(0),s.each(function(t){p=e.add(p,u.LaPlace.transform(t,a,c))},!0);else if(!s.isE()||s.power.group!==r&&s.power.group!==o){if(s.group!==l||-1===["sin","cos","sinh","cosh"].indexOf(s.fname)||s.args[0].group!==r&&s.args[0].group!==o){var v=t.Settings.integration_depth<t.Settings.Laplace_integration_depth;if(v){var g=t.Settings.integration_depth;t.Settings.integration_depth=t.Settings.Laplace_integration_depth}t.Utils.block("PARSE2NUMBER",function(){var n=a,r=s.sub(a,n),o=e.parse("e^(-"+c+"*"+n+")*"+r);(p=t.Calculus.integrate(o,n)).hasIntegral()&&e.error("Unable to compute transform"),p=p.sub(a,0),p=(p=e.expand(e.multiply(p,new i(-1)))).sub(n,a)},!1),p=t.Utils.block("PARSE2NUMBER",function(){return e.parse(p)},!0),v&&(t.Settings.integration_depth=g)}else{b=s.args[0].stripVar(a);switch(s.fname){case"sin":p=e.parse(n("({0})/(({1})^2+({0})^2)",b,c));break;case"cos":p=e.parse(n("({1})/(({1})^2+({0})^2)",b,c));break;case"sinh":p=e.parse(n("({0})/(({1})^2-({0})^2)",b,c));break;case"cosh":p=e.parse(n("({1})/(({1})^2-({0})^2)",b,c))}}}else{var b=s.power.stripVar(a);p=e.parse(n("1/(({1})-({0}))",b,c))}return e.multiply(p,m)},inverse:function(s,l,u){return t.Utils.block("POSITIVE_MULTIPLIERS",function(){if(s.group===r||s.group===o||s.group===a){var c,p,m,d,f,v,g,b,S,w=function(){(d=e.multiply(d,c)).multiplier=d.multiplier.multiply(s.multiplier),d=e.divide(d,f.a)};if(v=s.multiplier.clone(),s.toUnitMultiplier(),c=s.getNum(),(p=s.getDenom().toUnitMultiplier()).group===a?(g=p.power.clone(),p.toLinear()):g=new t.Frac(1),m=l.toString(),f=t.Utils.decompose_fn(p,m,!0),t.Utils.decompose_fn(e.expand(c.clone()),m,!0),c.multiplier=c.multiplier.multiply(v),(p.group===r||p.group===o)&&f.x.value===m&&f.b.equals(0)&&t.Utils.isInt(f.x.power))S=f.x.power-1,b=t.Math2.factorial(S),d=e.divide(e.pow(u,new i(S)),new i(b)),w();else if(p.group===a&&g.equals(1)){if(f.x.isLinear()&&!c.contains(m))u=e.divide(u,f.a.clone()),d=e.pow(new i("e"),e.multiply(u,f.b.negate())),w();else if(f.x.group===r&&f.x.power.equals(2))if(c.contains(m)){var q=new i(1);if(c.group===o){var h=new i(1);c.each(function(t){t.contains(m)?h=e.multiply(h,t):q=e.multiply(q,t)}),c=h}var y,x,U,_,L,V,E,M,P,C,F=t.Utils.decompose_fn(c,m,!0);if(y=F.a,x=F.b,U=y.containsFunction("sin"),L=y.containsFunction("cos"),_=x.containsFunction("cos"),V=x.containsFunction("sin"),F.x.value===m&&F.x.isLinear()&&!(U&&_||L||V))d=e.parse(n("(({1})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})",u,F.a,f.a,f.b));else if(U&&_)if(E=y.findFunction("sin"),M=x.findFunction("cos"),E.args[0].equals(M.args[0])&&!E.args[0].contains(m))R=e.divide(x,M.toUnitMultiplier()).toString(),P=E.args[0].toString(),k=f.b,C=e.divide(y,E.toUnitMultiplier()),D="(({1})*({2})*cos({3})*sin(sqrt({4})*({0})))/sqrt({4})+({1})*sin({3})*({5})*cos(sqrt({4})*({0}))",d=e.parse(n(D,u,q,R,P,k,C))}else d=e.parse(n("(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/sqrt(({2})*({3}))",u,c,f.a,f.b))}else if(f.x.power.num&&f.x.power.num.equals(3)&&f.x.power.den.equals(2)&&c.contains("sqrt(pi)")&&!c.contains(m)&&c.isLinear()){var R=e.divide(c.clone(),e.parse("sqrt(pi)"));d=e.parse(n("(2*({2})*sqrt({0}))/({1})",u,f.a,R,c))}else if(g.equals(2)&&f.x.power.equals(2)){var k,D;if(c.contains(m))if((F=t.Utils.decompose_fn(e.expand(c.clone()),m,!0)).x.isComposite()){var I=[],A=c.collectSymbols(function(e){e=i.unwrapPARENS(e);var n=t.Utils.decompose_fn(e,m,!0);return n.symbol=e,n}).sort(function(t,e){var i;return i=t.x.value!==m?0:t.x.power,(e.x.value!==m?0:e.x.power)-i});q=new i(-1);for(var N=0;N<A.length;N++){var z=A[N];z.x.value===m?I.push(z):q=e.multiply(q,z.symbol)}I[0].x.power.equals(2)&&I[1].x.power.equals(1)&&I[1].b.equals(0)&&!I[0].b.equals(0)&&(R=I[0].a.negate(),D="-(({1})*({2})*({5})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})^2*sqrt(({4})*({5})))-(({1})*({3})*({0})*sin((sqrt(({4})*({5}))*({0}))/({4})))/(2*({4})*sqrt(({4})*({5})))+(({1})*({2})*cos((sqrt(({4})*({5}))*({0}))/({4})))/({4})^2",d=e.parse(n(D,u,q,R,I[0].b,f.a,f.b)))}else F.x.isLinear()?(q=e.divide(F.a,new i(2)),D="(({1})*({0})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))",d=e.parse(n(D,u,q,f.a,f.b))):F.x.power.equals(2)&&(F.b.equals(0)?(q=e.divide(F.a,new i(2)),D="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*sqrt(({2})*({3})))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",d=e.parse(n(D,u,q,f.a,f.b))):(q=e.divide(F.a,new i(2)),k=F.b.negate(),D="-((({2})*({4})-2*({1})*({3}))*sin((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3})*sqrt(({2})*({3})))+(({4})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(2*({2})*({3}))+(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/({2})^2",d=e.parse(n(D,u,q,f.a,f.b,k))));else q=e.divide(c,new i(2)),D="(({1})*sin((sqrt(({2})*({3}))*({0}))/({2})))/(({3})*sqrt(({2})*({3})))-(({1})*({0})*cos((sqrt(({2})*({3}))*({0}))/({2})))/(({2})*({3}))",d=e.parse(n(D,u,q,f.a,f.b))}}return d||(d=e.symfunction("ilt",arguments)),d},!0)}},Statistics:{frequencyMap:function(t){for(var e={},i=0,n=t.length;i<n;i++){var s=t[i].toString();e[s]||(e[s]=0),e[s]++}return e},sort:function(t){return t.sort(function(t,i){return t.isConstant()&&i.isConstant()||e.error("Unable to sort! All values must be numeric"),t.multiplier.subtract(i.multiplier)})},count:function(t){return new i(t.length)},sum:function(t,n){for(var s=new i(0),r=0,a=t.length;r<a;r++){var o=t[r].clone();s=n?e.add(e.pow(e.subtract(o,n.clone()),new i(2)),s):e.add(o,s)}return s},mean:function(){var t=[].slice.call(arguments);return s(t[0])?u.Statistics.mean.apply(this,t[0].elements):e.divide(u.Statistics.sum(t),u.Statistics.count(t))},median:function(){var i,n=[].slice.call(arguments);if(s(n[0]))return u.Statistics.median.apply(this,n[0].elements);try{var r=u.Statistics.sort(n),a=n.length;if(t.Utils.even(a)){var o=a/2;i=u.Statistics.mean(r[o-1],r[o])}else i=r[Math.floor(a/2)]}catch(t){i=e.symfunction("median",n)}return i},mode:function(){var i,n=[].slice.call(arguments);if(s(n[0]))return u.Statistics.mode.apply(this,n[0].elements);var r,a=u.Statistics.frequencyMap(n),o=[],l=0,c=0,p=[];if(1===t.Utils.keys(a).length)return n[0];for(var m in a){var d=a[m],f=0===l;f&&(r=d),f||d>o[1]?(o[0]=m,o[1]=d):d===o[1]&&p.push(m),d===r&&c++,l++}return p.length>0?(p.push(o[0]),i=e.symfunction("mode",p.sort())):i=c===l?e.symfunction("mode",n):e.parse(o[0]),i},gVariance:function(t,i){var n=u.Statistics.mean.apply(u.Statistics,i),s=u.Statistics.sum(i,n);return e.multiply(t,s)},variance:function(){var t=[].slice.call(arguments);if(s(t[0]))return u.Statistics.variance.apply(this,t[0].elements);var n=e.divide(new i(1),u.Statistics.count(t));return u.Statistics.gVariance(n,t)},sampleVariance:function(){var t=[].slice.call(arguments);if(s(t[0]))return u.Statistics.sampleVariance.apply(this,t[0].elements);var n=e.divide(new i(1),e.subtract(u.Statistics.count(t),new i(1)));return u.Statistics.gVariance(n,t)},standardDeviation:function(){var t=[].slice.call(arguments);return s(t[0])?u.Statistics.standardDeviation.apply(this,t[0].elements):e.pow(u.Statistics.variance.apply(u.Statistics,t),new i(.5))},sampleStandardDeviation:function(){var t=[].slice.call(arguments);return s(t[0])?u.Statistics.sampleStandardDeviation.apply(this,t[0].elements):e.pow(u.Statistics.sampleVariance.apply(u.Statistics,t),new i(.5))},zScore:function(t,i,n){return e.divide(e.subtract(t,i),n)}},Units:{table:{foot:"12 inch",meter:"100 cm",decimeter:"10 cm"}}};nerdamer.register([{name:"laplace",visible:!0,numargs:3,build:function(){return u.LaPlace.transform}},{name:"ilt",visible:!0,numargs:3,build:function(){return u.LaPlace.inverse}},{name:"mean",visible:!0,numargs:-1,build:function(){return u.Statistics.mean}},{name:"median",visible:!0,numargs:-1,build:function(){return u.Statistics.median}},{name:"mode",visible:!0,numargs:-1,build:function(){return u.Statistics.mode}},{name:"smpvar",visible:!0,numargs:-1,build:function(){return u.Statistics.sampleVariance}},{name:"variance",visible:!0,numargs:-1,build:function(){return u.Statistics.variance}},{name:"smpstdev",visible:!0,numargs:-1,build:function(){return u.Statistics.sampleStandardDeviation}},{name:"stdev",visible:!0,numargs:-1,build:function(){return u.Statistics.standardDeviation}},{name:"zscore",visible:!0,numargs:3,build:function(){return u.Statistics.zScore}}]),nerdamer.api()}();